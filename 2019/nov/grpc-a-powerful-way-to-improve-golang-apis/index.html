<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.0ed0b1dd088b3cd0beff.css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}#disqus_thread{width:95%;margin:auto}.gatsby-highlight{background-color:#2d2d2d;border-radius:.3em;margin:2em 0;padding:1em;overflow:auto}.gatsby-highlight pre[class*=language-].line-numbers{padding:0 0 0 2.8em;overflow:initial}</style><meta name="generator" content="Gatsby 2.18.5"/><link rel="canonical" href="https://brunoluiz.net/2019/nov/grpc-a-powerful-way-to-improve-golang-apis/" data-baseprotocol="https:" data-basehost="brunoluiz.net"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><title data-react-helmet="true">Bruno Luiz Silva | GRPC: A powerful way to improve your Golang APIs</title><meta data-react-helmet="true" name="description" content="Web APIs are everywhere, with REST being one of the most popular ways to distribute it. With recent technologies, there are better ways to implement them, GRPC been one of them. Why REST is popular and what are its pitfalls? Companies used…"/><meta data-react-helmet="true" property="og:url" content="https://brunoluiz.net/2019/nov/grpc-a-powerful-way-to-improve-golang-apis/"/><meta data-react-helmet="true" property="og:title" content="GRPC: A powerful way to improve your Golang APIs"/><meta data-react-helmet="true" property="og:image" content="https://brunoluiz.net/static/36bdb77d6434a2431d688c0b730cd8dd/935ac/cover.jpg"/><meta data-react-helmet="true" property="og:description" content="Web APIs are everywhere, with REST being one of the most popular ways to distribute it. With recent technologies, there are better ways to implement them, GRPC been one of them. Why REST is popular and what are its pitfalls? Companies used…"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Bruno Luiz Silva"/><meta data-react-helmet="true" name="twitter:title" content="GRPC: A powerful way to improve your Golang APIs"/><meta data-react-helmet="true" name="twitter:description" content="Web APIs are everywhere, with REST being one of the most popular ways to distribute it. With recent technologies, there are better ways to implement them, GRPC been one of them. Why REST is popular and what are its pitfalls? Companies used…"/><meta data-react-helmet="true" name="google-site-verification" content="2za6GvvisJHVED9GglWd8xO4jWCp4GPpAKYBDM4ttx8"/><script data-react-helmet="true" src="https://my.remarkbox.com/static/js/iframe-resizer/iframeResizer.min.js"></script><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:106.25%/2 'Lora','Helvetica Neue',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Lora','Helvetica Neue',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;color:hsla(0,0%,0%,1);font-family:'Merriweather','Helvetica Neue','Helvetica','Arial',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;color:hsla(0,0%,0%,1);font-family:'Merriweather','Helvetica Neue','Helvetica','Arial',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.5rem;color:hsla(0,0%,0%,1);font-family:'Merriweather','Helvetica Neue','Helvetica','Arial',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;color:hsla(0,0%,0%,1);font-family:'Merriweather','Helvetica Neue','Helvetica','Arial',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;color:hsla(0,0%,0%,1);font-family:'Merriweather','Helvetica Neue','Helvetica','Arial',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;color:hsla(0,0%,0%,1);font-family:'Merriweather','Helvetica Neue','Helvetica','Arial',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}ul{margin-left:2rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;list-style-position:outside;list-style-image:none;}ol{margin-left:2rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;font-size:0.85rem;line-height:1.42;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:2rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;font-size:1rem;line-height:2rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}blockquote{margin-left:0;margin-right:2rem;margin-top:0;padding-bottom:0;padding-left:1.625rem;padding-right:0;padding-top:0;margin-bottom:2rem;font-size:1.1487rem;line-height:2rem;border-left:0.375rem solid #fca206;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(2rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:2rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(2rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:2rem;margin-bottom:calc(2rem / 2);margin-top:calc(2rem / 2);}li > ul{margin-left:2rem;margin-bottom:calc(2rem / 2);margin-top:calc(2rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(2rem / 2);}code{font-size:0.85rem;line-height:2rem;}kbd{font-size:0.85rem;line-height:2rem;}samp{font-size:0.85rem;line-height:2rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.33333rem;padding-right:1.33333rem;padding-top:1rem;padding-bottom:calc(1rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:none;}h1 > a, h2 > a, h3 > a{color:inherit;text-decoration:none;}h1 > a:hover, h2 > a:hover, h3 > a:hover{text-decoration:underline;}a{color:#d65947;}a:hover,a:active{color:hsla(0,0%,0%,0.8);}h1,h2,h3,h4,h5,h6{margin-top:3rem;line-height:1.5;}</style><link href="//fonts.googleapis.com/css?family=Lora:400,300,400i,300i,700|Merriweather:400,700" rel="stylesheet" type="text/css"/><style type="text/css" id="server-side-jss">.brandTitle-0-2-1 {
  color: #000;
  font-size: 2.82843rem;
  margin-top: 0;
  line-height: 4rem;
  margin-bottom: 2rem;
}
.brandTitle-0-2-1 a {
  color: inherit;
  text-decoration: none;
}
.brandTitleOnPost-0-2-2 {
  margin-top: 0;
}
.brandTitleOnPost-0-2-2 a {
  color: inherit;
  text-decoration: none;
}
.content-0-2-3 {
  padding: 3rem 1.5rem;
  max-width: 48rem;
  margin-left: auto;
  margin-right: auto;
}</style><link as="script" rel="preload" href="/webpack-runtime-07944a4fd72d81d02e52.js"/><link as="script" rel="preload" href="/app-9eb4ecafe9eb4feda61c.js"/><link as="script" rel="preload" href="/styles-9c945894fc27aeee5c8b.js"/><link as="script" rel="preload" href="/commons-24a7025303b3a13c9cfb.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-638b7eeb2fde7d8e8281.js"/><link as="fetch" rel="preload" href="/page-data/2019/nov/grpc-a-powerful-way-to-improve-golang-apis/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="content-0-2-3"><header><h3 class="brandTitleOnPost-0-2-2"><a href="/"> <!-- -->Bruno Luiz Silva<!-- --> </a></h3></header><main><h1>GRPC: A powerful way to improve your Golang APIs</h1><p style="font-size:0.87055rem;line-height:2rem;display:block;margin-bottom:2rem;margin-top:-2rem">December 05, 2019</p><div><p>
  <a
    class="gatsby-resp-image-link"
    href="/static/36bdb77d6434a2431d688c0b730cd8dd/7a1c5/cover.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block;  max-width: 780px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 66.67294294859725%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB5irqUJC//8QAGhAAAgIDAAAAAAAAAAAAAAAAAQIAERIhMf/aAAgBAQABBQILaBdumLzkJuf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAABBQAAAAAAAAAAAAAAAAABEBESIDH/2gAIAQEABj8CkhGtT//EABkQAQEBAQEBAAAAAAAAAAAAAAERAEFRIf/aAAgBAQABPyG5wM1Ce5yU9DVk5qqjkVfrv//aAAwDAQACAAMAAAAQTA//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QhX//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCn/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARIUExgf/aAAgBAQABPxBbIbAvTsulNAfYMwVcGHoNm6gQoTRiN1NVn//Z'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Photo by Israel Palacio on Unsplash"
        title=""
        src="/static/36bdb77d6434a2431d688c0b730cd8dd/bef22/cover.jpg"
        srcset="/static/36bdb77d6434a2431d688c0b730cd8dd/257c2/cover.jpg 195w,
/static/36bdb77d6434a2431d688c0b730cd8dd/d0630/cover.jpg 390w,
/static/36bdb77d6434a2431d688c0b730cd8dd/bef22/cover.jpg 780w,
/static/36bdb77d6434a2431d688c0b730cd8dd/1257c/cover.jpg 1170w,
/static/36bdb77d6434a2431d688c0b730cd8dd/731f5/cover.jpg 1560w,
/static/36bdb77d6434a2431d688c0b730cd8dd/48b41/cover.jpg 2340w,
/static/36bdb77d6434a2431d688c0b730cd8dd/7a1c5/cover.jpg 5311w"
        sizes="(max-width: 780px) 100vw, 780px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>Web APIs are everywhere, with REST being one of the most popular ways to distribute it. With recent technologies, there are better ways to implement them, GRPC been one of them.</p>
<h1>Why REST is popular and what are its pitfalls?</h1>
<p>Companies used to write web-services in SOAP until REST got enough hype to be the next big thing, although the concept has been around since 2000. It was like a fresh breeze for developers. It had a low learning curve, simplified payload (usually JSON instead of XML), schema-less approach and no need for specific clients/server generators.</p>
<p>At a certain point, some of its strengths shown to be some of its weaknesses. Not having a schema initially seemed a good idea, but developers eventually realised it is required. It can be useful for validation, documentation, contract agreement between teams and code-generation, to mention a few. Initiatives such as Swagger, RAML and most recently OpenAPI popped up trying to fill these gaps.</p>
<p>Even though, a lack of an official standard to guide through decision processes usually ended up in analysis paralysis in big projects. Besides, code generation in most of these tools was not as good and ready to use (example: swagger-tools).</p>
<p>JSON is the preferred way to return data from REST APIs. It is an excellent choice for public services used by front-end applications and third-parties. Due to its overhead on transporting and decoding, it is not well optimised for communication between internal services.</p>
<p>Even with these issues, it doesn’t mean REST is a bad choice. It is by far the simplest way to implement an API, but there are known pitfalls due to its simplicity. Technologies such as GraphQL, Thrift and GRPC come to fill these gaps.</p>
<h1>Enters GRPC and Protocol Buffers</h1>
<p>GRPC is a modern Remote Procedure Call (RPC) framework built on top-off HTTP 2.0, using Protocol Buffers as its interface definition language (IDL). These help it to be a low latency, high performance and scalable option to REST.</p>
<p>The strict use of HTTP 2.0 enables developers to embrace some of its features, mainly streaming (client-side and server-side). For example:</p>
<ul>
<li>A client can send a bulk of messages through a stream, instead of sending one request each or one with all of them</li>
<li>A client can send a request and receive a stream of responses, instead of waiting for the server to finish the processing and send a huge payload</li>
</ul>
<p>Protocol Buffers are a simpler and optimised way to define and serialise structured data. It can be used not only with GRPC but for other use cases, such as event modelling and data storage.</p>
<p>Think Swagger (REST) or WSDL (SOAP), but lightweight due to the fact the payloads are binary, allowing faster serialisation and smaller footprint. Being generated by tools such as <code>protoc</code>, it brings some benefits such as type checking in compile-time and auto-completion in IDEs.</p>
<p>In the snippet below, a GRPC service is defined using Protobuf. Generating a client and server requires a simple <code>protoc</code> call. Easy right?</p>
<div class="gatsby-highlight" data-language="protobuf"><pre style="counter-reset: linenumber NaN" class="language-protobuf line-numbers"><code class="language-protobuf">syntax <span class="token operator">=</span> <span class="token string">"proto3"</span><span class="token punctuation">;</span>

<span class="token keyword">package</span> api<span class="token punctuation">;</span>

<span class="token comment">// Defines where your go package will be placed after compilation</span>
option go_package <span class="token operator">=</span> <span class="token string">"api"</span><span class="token punctuation">;</span>

service Identity <span class="token punctuation">{</span>
  rpc GetUser <span class="token punctuation">(</span>GetUserRequest<span class="token punctuation">)</span> returns <span class="token punctuation">(</span>GetUserResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  rpc GetUsers <span class="token punctuation">(</span>GetUsersRequest<span class="token punctuation">)</span> returns <span class="token punctuation">(</span>GetUsersResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> User <span class="token punctuation">{</span>
  <span class="token primitive symbol">string</span> user_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token primitive symbol">string</span> name <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token primitive symbol">bool</span> active <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> GetUserRequest <span class="token punctuation">{</span>
  <span class="token primitive symbol">string</span> user_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> GetUserResponse <span class="token punctuation">{</span>
  User user <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> GetUsersRequest <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">message</span> GetUsersResponse <span class="token punctuation">{</span>
  <span class="token comment">// Defines an array of users</span>
  <span class="token builtin">repeated</span> User users <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>In any protobuf file, each field has a number associated with it. These uniquely identify a position of a field in the binary message, so they shouldn’t be changed. If one of these gets deprecated, they can’t be re-used. It helps on avoiding breaking changes, allowing a progressive model evolution. Developers don’t need to worry about fields being re-used and clashing with previous payloads of the message.</p>
<h1>Creating a simple GRPC server and client in Golang</h1>
<p><em><a href="https://github.com/brunoluiz/grpc-example">Code of this part available at Github brunoluiz/grpc-example@master</a></em></p>
<p>It is possible to create a simple GRPC server and client based on the previous protobuf definition. The following tools need to be installed:</p>
<ul>
<li><a href="https://github.com/protocolbuffers/protobuf">Protocol buffers compiler</a></li>
<li><a href="https://github.com/golang/protobuf">Golang protoc plugin</a></li>
</ul>
<p>In a Golang project, running <code>protoc -I. --go_out=plugins=grpc:./generated api/api.proto</code> will generate both server and client. The <code>go_package</code> option in the protobuf specifies the generated code output path. In this case it will be <code>./generated/api</code>.</p>
<p>To create a server, all methods defined by the proto need to be implemented by a Golang type. Peaking into the generated files, this is the interface generated from <code>service Identity</code>. A type which implements this interface should be enough to implement the server.</p>
<div class="gatsby-highlight" data-language="go"><pre style="counter-reset: linenumber NaN" class="language-go line-numbers"><code class="language-go"><span class="token comment">// File: api/generated/api.pb.go</span>

<span class="token keyword">type</span> IdentityServer <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">GetUser</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> <span class="token operator">*</span>GetUserRequest<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>GetUserResponse<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
	<span class="token function">GetUsers</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> <span class="token operator">*</span>GetUsersRequest<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>GetUsersResponse<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<div class="gatsby-highlight" data-language="go"><pre style="counter-reset: linenumber NaN" class="language-go line-numbers"><code class="language-go"><span class="token comment">// File: service/service.go</span>

<span class="token keyword">type</span> GRPCServer <span class="token keyword">struct</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>g <span class="token operator">*</span>GRPCServer<span class="token punctuation">)</span> <span class="token function">GetUser</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>api<span class="token punctuation">.</span>GetUserRequest<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>api<span class="token punctuation">.</span>GetUserResponse<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>g <span class="token operator">*</span>GRPCServer<span class="token punctuation">)</span> <span class="token function">GetUsers</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>api<span class="token punctuation">.</span>GetUsersRequest<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>api<span class="token punctuation">.</span>GetUsersResponse<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>With its implementation, the following code will be enough to run it as a server.</p>
<div class="gatsby-highlight" data-language="go"><pre style="counter-reset: linenumber NaN" class="language-go line-numbers"><code class="language-go"><span class="token comment">// File: cmd/server/main.go</span>

<span class="token comment">// Create a new GRPC Server</span>
s <span class="token operator">:=</span> grpc<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Register our service implementation against the GRPC service</span>
api<span class="token punctuation">.</span><span class="token function">RegisterIdentityServer</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> service<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// Listen to a specific port</span>
lis<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span><span class="token function">Getenv</span><span class="token punctuation">(</span><span class="token string">"GRPC_ADDRESS"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> err
<span class="token punctuation">}</span>

<span class="token comment">// Start serving</span>
<span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">Serve</span><span class="token punctuation">(</span>lis<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>A client will be generated by <code>protoc</code> as well. It can be created through <code>NewIdentityClient</code>, returning an <code>IdentityClient</code> implementation.</p>
<div class="gatsby-highlight" data-language="go"><pre style="counter-reset: linenumber NaN" class="language-go line-numbers"><code class="language-go"><span class="token comment">// File: api/generated/api.pb.go</span>

<span class="token keyword">type</span> IdentityClient <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">GetUser</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> in <span class="token operator">*</span>GetUserRequest<span class="token punctuation">,</span> opts <span class="token operator">...</span>grpc<span class="token punctuation">.</span>CallOption<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>GetUserResponse<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
	<span class="token function">GetUsers</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> in <span class="token operator">*</span>GetUsersRequest<span class="token punctuation">,</span> opts <span class="token operator">...</span>grpc<span class="token punctuation">.</span>CallOption<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>GetUsersResponse<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<div class="gatsby-highlight" data-language="go"><pre style="counter-reset: linenumber NaN" class="language-go line-numbers"><code class="language-go"><span class="token comment">// File: cmd/client/main.go</span>

<span class="token comment">// Set up a connection to the server.</span>
conn<span class="token punctuation">,</span> err <span class="token operator">:=</span> grpc<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">"grpc-address"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> grpc<span class="token punctuation">.</span><span class="token function">WithInsecure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> grpc<span class="token punctuation">.</span><span class="token function">WithBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> err
<span class="token punctuation">}</span>
<span class="token keyword">defer</span> conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Create GRPC Client</span>
client <span class="token operator">:=</span> api<span class="token punctuation">.</span><span class="token function">NewIdentityClient</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>

<span class="token comment">// Call GRPC Service and Get User</span>
u<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">GetUser</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>api<span class="token punctuation">.</span>GetUserRequest<span class="token punctuation">{</span>
  UserId<span class="token punctuation">:</span> c<span class="token punctuation">.</span><span class="token function">Args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> errors<span class="token punctuation">.</span><span class="token function">Wrap</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token string">"issue on retrieving users"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Of course, this is the bare minimum set-up for a client and server. Interceptors can be added on both client and server, adding custom hooks to any method call and applying some transformations.</p>
<p>UnaryInterceptors deal with requests which expect a single response back. StreamInterceptors applies to any streamed response or request. <a href="https://davidsbond.github.io/2019/06/14/creating-grpc-interceptors-in-go.html">In this article</a> by David Bond, there is more information about interceptors and how to implement custom ones.</p>
<p>Most common interceptors, such as authorisation, validation, monitoring can be found at <a href="https://github.com/grpc-ecosystem/go-grpc-middleware">go-grpc-middleware</a>. Remember, don’t repeat yourself 😉</p>
<p><em><a href="https://github.com/brunoluiz/grpc-example">Code of this part available at Github brunoluiz/grpc-example@master</a></em></p>
<h1>GRPC and REST together: What is this, a crossover episode?</h1>
<p><em><a href="https://github.com/brunoluiz/grpc-example/pull/1">Code of this part available at Github brunoluiz/grpc-example@with-gateway</a></em></p>
<p>As previously mentioned, REST simplicity and low learning curve are some of its selling points. It allows quick testing, without the need to set-up a client binary — who never did a quick <code>curl</code> to check some API? Besides, it is easier for non-developers to play with it. As it is web services <em>lingua franca,</em> it might be required for third-party or front-end integrations as well.</p>
<p>GRPC might be more efficient and better in some cases, but it is not as straightforward to use as REST. What if both could be used together, within the same service? That is where <a href="https://github.com/grpc-ecosystem/grpc-gateway">GRPC Gateway</a> shines, integrating both worlds in one.</p>
<p>Through annotations, a service can define which methods will be exposed as REST. Using the previous GRPC protobuf, here is an example — note the <code>google.api.http</code> options:</p>
<div class="gatsby-highlight" data-language="protobuf"><pre style="counter-reset: linenumber NaN" class="language-protobuf line-numbers"><code class="language-protobuf"><span class="token keyword">import</span> <span class="token string">"google/api/annotations.proto"</span><span class="token punctuation">;</span>

service Identity <span class="token punctuation">{</span>
  rpc GetUser <span class="token punctuation">(</span>GetUserRequest<span class="token punctuation">)</span> returns <span class="token punctuation">(</span>GetUserResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Maps GetUser to an HTTP GET request, with the param `user_id`</span>
    <span class="token comment">// been mapped to GetUserRequest.user_id</span>
    option <span class="token punctuation">(</span>google<span class="token punctuation">.</span>api<span class="token punctuation">.</span>http<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      get<span class="token punctuation">:</span> <span class="token string">"/v1/users/{user_id}"</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  rpc GetUsers <span class="token punctuation">(</span>GetUsersRequest<span class="token punctuation">)</span> returns <span class="token punctuation">(</span>GetUsersResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Maps GetUsers to an HTTP GET request</span>
    option <span class="token punctuation">(</span>google<span class="token punctuation">.</span>api<span class="token punctuation">.</span>http<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      get<span class="token punctuation">:</span> <span class="token string">"/v1/users"</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>With annotations in place, <code>protoc</code> needs to be changed to use the <code>grpc-gateway</code> plugin.</p>
<ul>
<li><a href="https://github.com/grpc-ecosystem/grpc-gateway#installation">Install grpc-gateway locally</a></li>
<li>Add GRPC Gateway paths to import paths (<code>-I$(GOPATH)/src/github.com/grpc-ecosystem/grpc-gateway/third\_party/googleapis</code>)</li>
<li>Add <code>--grpc-gateway_out=logtostderr=true:./generated</code> to generate gateway code. It will place at <code>go_package</code> path</li>
<li>Add <code>--grpc-swagger_out=logtostderr=true:.</code> to generate Swagger definitions. It will place it in the same folder as the proto file.</li>
</ul>
<div class="gatsby-highlight" data-language="makefile"><pre style="counter-reset: linenumber NaN" class="language-makefile line-numbers"><code class="language-makefile">protoc -I. \
  -I<span class="token variable">$</span><span class="token punctuation">(</span>GOPATH<span class="token punctuation">)</span>/src \
  -I<span class="token variable">$</span><span class="token punctuation">(</span>GOPATH<span class="token punctuation">)</span>/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \
  --grpc-gateway_out<span class="token operator">=</span>logtostderr<span class="token operator">=</span>true<span class="token punctuation">:</span>./generated \
  --swagger_out<span class="token operator">=</span>logtostderr<span class="token operator">=</span>true<span class="token punctuation">:</span>. \
  --go_out<span class="token operator">=</span>plugins<span class="token operator">=</span>grpc<span class="token punctuation">:</span>./generated \
  api/api.proto</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>After running <code>protoc</code>, the reverse-proxy code will be available for use. It is just a matter of creating an HTTP server for it. The following implementation is running it in a separate server.</p>
<div class="gatsby-highlight" data-language="go"><pre style="counter-reset: linenumber NaN" class="language-go line-numbers"><code class="language-go"><span class="token comment">// File: cmd/gateway/main.go</span>

<span class="token comment">// Note: Make sure the gRPC server is running properly and accessible</span>

mux <span class="token operator">:=</span> runtime<span class="token punctuation">.</span><span class="token function">NewServeMux</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
opts <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>grpc<span class="token punctuation">.</span>DialOption<span class="token punctuation">{</span>grpc<span class="token punctuation">.</span><span class="token function">WithInsecure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>

<span class="token comment">// Register gRPC server endpoint</span>
<span class="token keyword">if</span> err <span class="token operator">:=</span> api<span class="token punctuation">.</span><span class="token function">RegisterIdentityHandlerFromEndpoint</span><span class="token punctuation">(</span>
  context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mux<span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">"grpc-address"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> err
<span class="token punctuation">}</span>

<span class="token comment">// Start HTTP reverse proxy: sends calls to GRPC server</span>
<span class="token keyword">return</span> http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">"gateway-address"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mux<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Any REST client should be able to request data from the Gateway. Server up, this is curl’s output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">➜  ~ <span class="token function">curl</span> localhost:8080/v1/users
<span class="token punctuation">{</span><span class="token string">"users"</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"user_id"</span><span class="token keyword">:</span><span class="token string">"xyz"</span>,<span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"Pelican Steve"</span>,<span class="token string">"active"</span>:true<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">"user_id"</span><span class="token keyword">:</span><span class="token string">"foo"</span>,<span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"John Doe"</span>,<span class="token string">"active"</span>:true<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">"user_id"</span><span class="token keyword">:</span><span class="token string">"bar"</span>,<span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"Chauffina Carr"</span>,<span class="token string">"active"</span>:true<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
➜  ~ <span class="token function">curl</span> localhost:8080/v1/users/xyz
<span class="token punctuation">{</span><span class="token string">"user"</span>:<span class="token punctuation">{</span><span class="token string">"user_id"</span><span class="token keyword">:</span><span class="token string">"xyz"</span>,<span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"Pelican Steve"</span>,<span class="token string">"active"</span>:true<span class="token punctuation">}</span><span class="token punctuation">}</span>
➜  ~ <span class="token function">curl</span> localhost:8080/v1/users/aaa
<span class="token punctuation">{</span><span class="token string">"error"</span><span class="token keyword">:</span><span class="token string">"resource was not found"</span>,<span class="token string">"code"</span>:5,<span class="token string">"message"</span><span class="token keyword">:</span><span class="token string">"resource was not found"</span><span class="token punctuation">}</span>%</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Magic, isn’t it? Having this REST set-up might put a smile on some faces. The service can be migrated to GRPC for internal usage, keeping compatibility with REST clients — third-parties, non-techies and front-end applications.</p>
<p><a href="https://www.gophercon.co.uk/videos/2019/writing-rest-services-for-the-grpc-curious/">There is an excellent talk</a> by Johan Brandhorst giving more details on GRPC Gateway.</p>
<p><em><a href="https://github.com/brunoluiz/grpc-example/pull/1">Code of this part available at Github brunoluiz/grpc-example@with-gateway</a></em></p>
<h1>Fantastic debugging tools and where to find them</h1>
<p>Sooner or later, a quick peek into the service will be required, for debugging or scriptting purposes. In REST this can be done through tools such as curl, Insomnia or Postman. In GRPC, a different set of tools is required.</p>
<p>For the Graphical Interface lovers, the most popular one is <a href="https://github.com/uw-labs/bloomrpc">BloomRPC</a>. It only requires the proto files to be loaded and then it works similarly to any other REST client.</p>
<p><img src="https://github.com/uw-labs/bloomrpc/raw/873953c6b00906a69f165c332634b946c7724fe9/resources/editor-preview.gif" alt="BloomRPC demo"></p>
<p>For mouse avoiders — or terminal lovers 😅 — there are two quite useful tools. <a href="https://github.com/fullstorydev/grpcurl">GRPCurl</a> is an awesome CLI tool, resembling curl and allow easy GRPC automation and scripting. A simple example of its usage follows:</p>
<p><code>grpcurl --plaintext --proto api/api.proto localhost:5000 api.Identity/GetUsers</code></p>
<p><a href="https://github.com/ktr0731/evans">Evans</a> goes a little bit further, as it has a REPL mode as well, allowing easier resource inspections (my favourite).</p>
<p><img src="https://github.com/ktr0731/evans/raw/97d1de81aa4ea471a14f4db56bf04830c6d79c39/evans1.gif" alt="Evan REPL Demo"></p>
<p>These tools, GUI or not, are quite useful while testing and inspecting GRPC services. Try them and find the one which fits your needs better 😉</p>
<h1>My experience using it</h1>
<p>In my workplace GRPC has proved quite useful for connecting services, especially internal ones. Protocol Buffers came to be our main IDL when defining contracts for APIs and Stream Events. Due to these contracts, communicating implementations and changes are easier.</p>
<p>Implementing service clients and servers had been easier and faster. The most common issue is due to include paths errors, which sometimes get messy. But this is more due to our learnings around it than the technology itself. Some of the boilerplate, such as registering the server or dialing the client, can be tackled by creating custom protoc plugins. This proved quite useful, specially when the team is more product-oriented.</p>
<p>For Golang, it proved to work quite well in most cases, with good community support. But, <code>protoc</code> can generate code to other languages as well, such as NodeJS and Java. Although, in our NodeJS services, we felt GRPC support is still lacking behind Golang.</p>
<p>In general, GRPC has been a good choice for our services. Hopefully, it will be good for your team as well.</p></div><hr style="margin-bottom:2rem"/><div>A collection of random software engineering thoughts</div><a href="mailto:contact@brunoluiz.net">e-mail</a> • <a href="https://twitter.com/brunoluiz">twitter</a> • <a href="https://github.com/brunoluiz">github</a> • <a href="/rss.xml">rss</a><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0;margin-left:0"><li><a rel="prev" href="/graphql-as-a-gateway/">← <!-- -->GraphQL feat API Gateway</a></li><li></li></ul><div id="disqus_thread" identifier="4d16ba7e-6f53-5d05-ac6b-b1ec31d169a8" title="GRPC: A powerful way to improve your Golang APIs"></div></main></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2019/nov/grpc-a-powerful-way-to-improve-golang-apis/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-9eb4ecafe9eb4feda61c.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-638b7eeb2fde7d8e8281.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a41cd6bb6c53985aeff9.js"],"component---src-pages-index-js":["/component---src-pages-index-js-fe40720d36cdb724f2da.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-638b7eeb2fde7d8e8281.js" async=""></script><script src="/commons-24a7025303b3a13c9cfb.js" async=""></script><script src="/styles-9c945894fc27aeee5c8b.js" async=""></script><script src="/app-9eb4ecafe9eb4feda61c.js" async=""></script><script src="/webpack-runtime-07944a4fd72d81d02e52.js" async=""></script></body><script>
  const path = "u=" + encodeURIComponent(window.location.pathname);
  const referrer = document.referrer ? "&r=" + encodeURIComponent(document.referrer) : ""
  const time = "&t=" + (new Date()).getTime()

  const _pixel = new Image(1, 1);
  _pixel.src = 'https://goaccess.snapdiff.com/pixel?' + path + referrer + time;
              </script></html>